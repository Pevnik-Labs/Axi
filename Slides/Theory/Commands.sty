\ProvidesPackage{Commands}

\usepackage{xparse}

% Pipes - used when specifying grammars in BNF format.
\newcommand{\pipe}{\ |\ }

% Programming language.

% Quantities.
\newcommand{\Zero}{0}
\newcommand{\One}{1}
\newcommand{\ExplicitOmega}{\omega}

% Subusaging - order on quantities.
\NewDocumentCommand{\subusage}{m m}{#1 \leq #2}

% Operations on quantities.
\NewDocumentCommand{\addqty}{m m}{#1 + #2}
\NewDocumentCommand{\mulqty}{m m}{#1 \cdot #2}

% Types.
\NewDocumentCommand{\Fun}{o m m}{\IfValueTF{#1}{#1\ }{} #2 \to #3}
\RenewDocumentCommand{\Box}{o m}{\texttt{!}_{#1}\, #2}
%\newcommand{\Fun}[2]{#1 \to #2}
\newcommand{\Prod}[2]{#1 \otimes #2}
\newcommand{\Sum}[2]{#1 \oplus #2}
\newcommand{\Unit}{\textbf{1}}
\newcommand{\Empty}{\textbf{0}}
%\newcommand{\ForallT}[2]{\forall #1.\, #2}

% An optional type annotation.
\newcommand{\optionalannot}[1]{\IfValueTF{#1}{: #1}{}}
\newcommand{\optionalspace}[1]{\IfValueTF{#1}{\ #1}{}}

% Terms.
%\newcommand{\annot}[2]{(#1 : #2)}
\NewDocumentCommand{\fun}{o m o m}{\lambda_{#1}\, #2 \optionalannot{#3} .\, #4}
\NewDocumentCommand{\app}{m m}{#1\ #2}
\NewDocumentCommand{\boxintro}{o m}{\texttt{box}_{#1}\ #2}
\NewDocumentCommand{\boxelim}{m m m}{\texttt{letbox}\ #1 = #2\ \texttt{in}\ #3}
\NewDocumentCommand{\letin}{o m m m}{\texttt{let}_{#1}\ #2 = #3\ \texttt{in}\ #4}
\newcommand{\pair}[2]{(#1, #2)}
\newcommand{\outl}[2][]{\texttt{outl}_{#1}\ #2}
\newcommand{\outr}[2][]{\texttt{outr}_{#1}\ #2}
\newcommand{\inl}[2][]{\texttt{inl}_{#1}\ #2}
\newcommand{\inr}[2][]{\texttt{inr}_{#1}\ #2}
\newcommand{\case}[3]{\texttt{case}\ #1\ \texttt{of}\ (#2, #3)}
\newcommand{\unit}{\texttt{unit}}
\newcommand{\emptyelim}[2][]{\Empty\texttt{-elim}_{#1}\ #2}
\RenewDocumentCommand{\choose}{m}{\texttt{choose}\ #1}
\NewDocumentCommand{\choosewitnessp}{m m m m}{\texttt{choose-witness}\ #1\ #2\ \texttt{for}\ #3\ \texttt{in}\ #4}

% Logic.

% Propositions.

% Propositional logic.
\newcommand{\True}{\top}
\newcommand{\False}{\bot}
\newcommand{\Not}[1]{\neg #1}
\newcommand{\Or}[2]{#1 \lor #2}
\renewcommand{\And}[2]{#1 \land #2}
\newcommand{\Impl}[2]{#1 \Rightarrow #2}
\newcommand{\Iff}[2]{#1 \Leftrightarrow #2}

% Quantifiers.
\NewDocumentCommand{\All}{m o m}{\forall #1 \optionalannot{#2} .\, #3}
\NewDocumentCommand{\Ex}{m o m}{\exists #1 \optionalannot{#2} .\, #3}

% Equality.
\newcommand{\Eq}[3][]{#2 =_{#1} #3}

% Proofterms.

% Propositional logic.
\NewDocumentCommand{\assumption}{}{\textbf{assumption}}
\NewDocumentCommand{\implintro}{m o m}{\textbf{assume}\ #1 \optionalannot{#2}\ \textbf{in}\ #3}
\newcommand{\implelim}[2]{\textbf{apply}\ #1\ #2}
\newcommand{\trueintro}{\textbf{trivial}}
\newcommand{\falseelim}[1]{\textbf{absurd}\ #1}
%\newcommand{\notintro}[2]{\textbf{suppose-absurd}\ #1\ \textbf{in}\ #2}
%\newcommand{\notelim}[2]{\textbf{absurd}\ #1\ #2}
\newcommand{\andintro}[2]{\textbf{both}\ #1\ #2}
\newcommand{\andeliml}[1]{\textbf{and-left}\ #1}
\newcommand{\andelimr}[1]{\textbf{and-right}\ #1}
\NewDocumentCommand{\orintrol}{m}{\textbf{or-left}\ #1}
\NewDocumentCommand{\orintror}{m}{\textbf{or-right}\ #1}
\newcommand{\orelim}[3]{\textbf{cases}\ #1\ #2\ #3}
%\newcommand{\iffintro}[2]{\textbf{equivalence}\ #1\ #2}
%\newcommand{\iffeliml}[1]{\textbf{left-iff}\ #1}
%\newcommand{\iffelimr}[1]{\textbf{right-iff}\ #1}
\RenewDocumentCommand{\lemma}{m m m m}{\textbf{lemma}\ #1 : #2\ \textbf{by}\ #3\ \textbf{in}\ #4}
\NewDocumentCommand{\proofannot}{m m}{\textbf{proving}\ #1\ \textbf{by}\ #2}

% Classical logic.
\NewDocumentCommand{\bycontradiction}{m o m}{\textbf{by-contradiction}\ #1 \optionalannot{#2}\ \textbf{in}\ #3}
\NewDocumentCommand{\choosespec}{m}{\textbf{choose-spec}\ #1}
\NewDocumentCommand{\choosewitnessl}{m m m m}{\textbf{choose-witness}\ #1\ #2\ \textbf{for}\ #3\ \textbf{in}\ #4}

% Quantifiers.
\NewDocumentCommand{\allintro}{m o m}{\textbf{pick-any}\ #1 \optionalannot{#2}\ \textbf{in}\ #3}
\newcommand{\allelim}[2]{\textbf{instantiate}\ #1\ \textbf{with}\ #2}
\NewDocumentCommand{\exintro}{m m}{\textbf{witness}\ #1\ \textbf{such that}\ #2}
\NewDocumentCommand{\exelim}{m m m m}{\textbf{pick-witness}\ #1\ #2\ \textbf{for}\ #3\ \textbf{in}\ #4}

% Equality.
\NewDocumentCommand{\refl}{o}{\textbf{refl} \optionalspace{#1}}
\newcommand{\rewrite}[2]{\textbf{rewrite}\ #1\ \textbf{in}\ #2}
\NewDocumentCommand{\funext}{m o m}{\textbf{funext}\ #1 \optionalannot{#2}\ \textbf{in}\ #3}

% Contexts.

% Typing contexts.
\newcommand{\emptyctx}{\cdot}
\NewDocumentCommand{\extend}{m o m m o}{#1, \IfValueTF{#2}{#2\,}{} #3 : #4 \IfValueTF{#5}{:= #5}{}}
\NewDocumentCommand{\assume}{m m m}{#1, #2 : #3}
\NewDocumentCommand{\extendtype}{m m}{#1, #2}

% Context operations.
\NewDocumentCommand{\addctx}{m m}{#1 + #2}
\NewDocumentCommand{\scalectx}{m m}{#1\, #2}
\NewDocumentCommand{\subctx}{m m}{#1 \leq #2}
\NewDocumentCommand{\cartesianize}{m}{| #1 |}

% Judgements.

% Cartesian context.
\NewDocumentCommand{\cartesian}{m}{#1\ \texttt{cartesian}}

% Valid type.
\NewDocumentCommand{\type}{O{\Gamma} m}{#1 \vdash #2\ \texttt{type}}

% Declarative typing.
\NewDocumentCommand{\typing}{m m m}{#1 \vdash #2 : #3}

% Well-formed proposition.
\NewDocumentCommand{\prop}{O{\Gamma} m}{#1 \vdash #2\ \texttt{prop}}

% Proof judgement.
\NewDocumentCommand{\proves}{O{\Gamma} m m}{#1 \vdash #2 : #3}

% Inference rules.
\newcommand{\rulename}[1]{\textsc{\footnotesize{#1}}}
\newcommand{\infrule}[3][]{\displaystyle \frac{#2}{#3} \rulename{#1}}

% Side conditions - this command semantically marks side conditions in inference rules, but otherwise does nothing.
\newcommand{\sidecond}[1]{#1}

% Substitution.
\NewDocumentCommand{\subst}{m m m}{#1\left[#2 := #3\right]}