\documentclass{beamer}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{xcolor}
\usepackage{Commands}

\usetheme{Darmstadt}

\title{T-Axi (algorithmic)}
\author
{
  Wojciech Ko≈Çowski\\
  \and
  Mateusz Pyzik\\
}
\date{}

\begin{document}

\frame{\titlepage}

\section{Quantities}

\begin{frame}{Subtraction of quantities}

$\subqty{r_1}{r_2}$ is the least $r'$ such that $\subusage{r_1}{\addqty{r'}{r_2}}$.

\vspace{2em}

\begin{table}[ht]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|}
  \hline
  $\subqty{r_1}{r_2}$ & $\Zero$ & $\One$  & $\Few$  & $\Many$ & $\Any$  \\ \hline
  $\Zero$             & $\Zero$ &         &         &         &         \\ \hline
  $\One$              & $\One$  & $\Zero$ &         &         &         \\ \hline
  $\Few$              & $\Few$  & $\Zero$ & $\Zero$ &         &         \\ \hline
  $\Many$             & $\Many$ & $\Any$  & $\Many$ & $\Any$  & $\Many$ \\ \hline
  $\Any$              & $\Any$  & $\Any$  & $\Any$  & $\Any$  & $\Any$  \\ \hline
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}{Subtraction order on quantities}

$\lesubqty{r_1}{r_2}$ holds when $\subqty{r_2}{r_1}$ is defined.

\vspace{2em}

Explicitly: $\Zero \lesubqty{}{} \One \lesubqty{}{} \Few \lesubqty{}{} \Many \lesubqty{}{} \Any \lesubqty{}{} \Many$

\end{frame}

\begin{frame}{Decrementation order on quantities}

$\ledecqty{r_1}{r_2}$ holds when $\subqty{r_2}{\One} = r_1$.

\begin{center}
  $\infrule{}{\ledecqty{\Any}{\Many}}$

  \vspace{2em}

  $\infrule{}{\ledecqty{\Zero}{\One}}$

  \vspace{2em}

  $\infrule{}{\ledecqty{\Zero}{\Few}}$
\end{center}

\end{frame}

\begin{frame}{Arithmetic order on quantities}

The arithmetic order on quantities is $\Zero \learithqty \One \learithqty \Few \learithqty \Many \learithqty \Any$. The idea is to compare the quantities by how ``big'' they are.

\end{frame}

\begin{frame}{Division with remainder}

$\divqty{a}{b} = (q, r)$ when $a = \addqty{\mulqty{b}{q}}{r}$, with $q$ as large as possible and $r$ being as small as possible according to the arithmetic order. Note that $\divqty{a}{b} = q$ means that $r = \Zero$.

\vspace{2em}

\begin{table}[ht]
  \centering
  \begin{tabular}{|c|c|c|c|c|c|}
  \hline
  $\divqty{r_1}{r_2}$ & $\Zero$         & $\One$  & $\Few$          & $\Many$         & $\Any$          \\ \hline
  $\Zero$             & $\Any$          & $\Zero$ & $\Zero$         & $\Zero$         & $\Zero$         \\ \hline
  $\One$              & $(\Any, \One)$  & $\One$  & $(\Zero, \One)$ & $(\Zero, \One)$ & $(\Zero, \One)$ \\ \hline
  $\Few$              & $(\Any, \Few)$  & $\Few$  & $\Few$          & $(\Zero, \Few)$ & $(\Zero, \Few)$ \\ \hline
  $\Many$             & $(\Any, \Many)$ & $\Many$ & $(\Any, \One)$  & $\Many$         & $(\Any, \One)$  \\ \hline
  $\Any$              & $(\Any, \Any)$  & $\Any$  & $\Any$          & $\Any$          & $\Any$          \\ \hline
  \end{tabular}
\end{table}

\end{frame}

\section{Contexts}

\begin{frame}{Decrement variable in context}

\begin{center}
  $\usevar{\emptyctx}{x} = \mathbf{undefined}$ \\
  $\usevar{(\extend{\Gamma}[r]{x}{A})}{x} = \extend{\Gamma}[(\subqty{r}{\One})]{x}{A}$ \\
  $\usevar{(\extend{\Gamma}[r]{y}{A})}{x} = \extend{\usevar{\Gamma}{x}}[r]{y}{A}$ \\
  $\usevar{(\extend{\Gamma}[r]{x}{A}[e])}{x} = \extend{\Gamma}[(\subqty{r}{\One})]{x}{A}[e]$ \\
  $\usevar{(\extend{\Gamma}[r]{y}{A}[e])}{x} = \extend{\usevar{\Gamma}{x}}[r]{y}{A}[e]$ \\
  $\usevar{(\assume{\Gamma}{h}{P})}{x} = \assume{\usevar{\Gamma}{x}}{h}{P}$
\end{center}

\end{frame}

\begin{frame}{Context division with remainder}

\begin{center}
  $\infrule{}{\divctx{\emptyctx}{r} = \emptyctx}$

  \vspace{2em}

  $\infrule{\divctx{\Gamma}{q} = (\Gamma_1, \Gamma_2) \quad \divqty{r}{q} = (r_1, r_2)}{\divctx{(\extend{\Gamma}[r]{x}{A})}{q} = ((\extend{\Gamma_1}[r_1]{x}{A}), (\extend{\Gamma_2}[r_2]{x}{A}))}$

  \vspace{2em}

  $\infrule{\divctx{\Gamma}{q} = (\Gamma_1, \Gamma_2) \quad \divqty{r}{q} = (r_1, r_2)}{\divctx{(\extend{\Gamma}[r]{x}{A}[e])}{q} = ((\extend{\Gamma_1}[r_1]{x}{A}[e]), (\extend{\Gamma_2}[r_2]{x}{A}[e]))}$

  \vspace{2em}

  $\infrule{\divctx{\Gamma}{q} = \Gamma'}{\divctx{(\assume{\Gamma}{h}{P})}{q} = ((\assume{\Gamma'}{h}{P}), (\assume{\Gamma'}{h}{P}))}$
\end{center}

\end{frame}

\section{Typing}

\RenewDocumentCommand{\check}{m m m m}{#1 \vdash #2 \mathcolor{blue}{\Leftarrow} #3 \dashv #4}
\NewDocumentCommand{\infer}{m m m m}{#1 \vdash #2 \mathcolor{red}{\Rightarrow} #3 \dashv #4}

\NewDocumentCommand{\findvar}{m m}{#1(#2)}

\begin{frame}{Using variables}

\begin{center}
  $\infrule{\findvar{\Gamma}{x} = A}{\infer{\Gamma}{x}{A}{\usevar{\Gamma}{x}}}$
\end{center}

\end{frame}

\begin{frame}{Functions}

\begin{center}
  $\infrule{\check{\extend{\Gamma}[r]{x}{A}}{e}{B}{\extend{\Gamma'}[r']{x}{A}} \quad \subusage{r'}{\Zero}}{\check{\Gamma}{\fun{x}{e}}{\Fun[r]{A}{B}}{\Gamma'}}$

  \vspace{2em}

  $\infrule{\infer{\Gamma}{f}{\Fun[r]{A}{B}}{\Gamma_1} \quad \divctx{\Gamma_1}{r} = (\Gamma_2, \Gamma_3) \quad \check{\Gamma_2}{a}{A}{\Gamma_4}}{\infer{\Gamma}{\app{f}{a}}{B}{\addctx{\Gamma_3}{\scalectx{r}{\Gamma_4}}}}$

  \vspace{2em}

  Useful shorthand (when not enough space):

  \vspace{1em}

  $\infrule{\check{\extend{\Gamma}[r]{x}{A}}{e}{B}{\extend{\Gamma'}[\Zero]{x}{A}}}{\check{\Gamma}{\fun{x}{e}}{\Fun[r]{A}{B}}{\Gamma'}}$
\end{center}

\end{frame}

\begin{frame}{Box}

\begin{center}
  $\infrule{\divctx{\Gamma}{r} = (\Gamma_1, \Gamma_2) \quad \check{\Gamma_1}{e}{A}{\Gamma_3}}{\check{\Gamma}{\boxintro{e}}{\Box[r]{A}}{\addctx{\Gamma_2}{\scalectx{r}{\Gamma_3}}}}$

  \vspace{2em}

  $\infrule{\infer{\Gamma}{e_1}{\Box[r]{A}}{\Gamma_1} \quad \infer{\extend{\Gamma_1}[r]{x}{A}}{e_2}{B}{\extend{\Gamma_2}[r']{x}{A}} \quad \subusage{r'}{\Zero}}{\infer{\Gamma}{\boxelim{x}{e_1}{e_2}}{B}{\Gamma_2}}$
\end{center}

\end{frame}

\begin{frame}{Empty}

\begin{center}
  $\infrule{\check{\Gamma}{e}{\Empty}{\Gamma'}}{\check{\Gamma}{\emptyelim{e}}{A}{\Gamma'}}$
\end{center}

\end{frame}

\begin{frame}{Unit}

\begin{center}
  $\infrule{}{\check{\Gamma}{\unit}{\Unit}{\Gamma}}$

  \vspace{2em}

  $\infrule{\infer{\Gamma}{e_1}{\Unit}{\Gamma_1} \quad \infer{\Gamma_1}{e_2}{A}{\Gamma_2}}{\infer{\Gamma}{\unitelim{e_1}{e_2}}{A}{\Gamma_2}}$
\end{center}

\end{frame}

\begin{frame}{Products}

\begin{center}
    $\infrule{\check{\Gamma}{a}{A}{\Gamma_1} \quad \check{\Gamma_1}{b}{B}{\Gamma_2}}{\check{\Gamma}{\pair{a}{b}}{\Prod{A}{B}}{\Gamma_2}}$

    \vspace{2em}

    $\infrule{\infer{\Gamma}{e_1}{\Prod{A}{B}}{\Gamma_1} \quad \infer{\extend{\extend{\Gamma_1}[\One]{x}{A}}[\One]{y}{B}}{e_2}{C}{\extend{\extend{\Gamma_2}[\Zero]{x}{A}}[\Zero]{y}{B}}}{\infer{\Gamma}{\letpair{x}{y}{e_1}{e_2}}{C}{\Gamma_2}}$
\end{center}

\end{frame}

\begin{frame}{Sums}

\begin{center}
  $\infrule{\check{\Gamma}{e}{A}{\Gamma'}}{\check{\Gamma}{\inl{e}}{\Sum{A}{B}}{\Gamma'}}$ \quad
  $\infrule{\check{\Gamma}{e}{B}{\Gamma'}}{\check{\Gamma}{\inr{e}}{\Sum{A}{B}}{\Gamma'}}$

  \vspace{2em}

  $\infrule{\infer{\Gamma}{e}{\Sum{A}{B}}{\Gamma_1} \quad \begin{array}{l} \check{\Gamma_1}{f}{\Fun[\One]{A}{C}}{\Gamma_2} \\ \check{\Gamma_1}{g}{\Fun[\One]{B}{C}}{\Gamma_3} \end{array}}{\check{\Gamma}{\case{e}{f}{g}}{C}{\Gamma_2 \sqcup \Gamma_3}}$

  \vspace{2em}

  $\infrule{\infer{\Gamma}{e}{\Sum{A}{B}}{\Gamma_1} \quad \begin{array}{l} \infer{\Gamma_1}{f}{\Fun[\One]{A}{C}}{\Gamma_2} \\ \infer{\Gamma_1}{g}{\Fun[\One]{B}{C}}{\Gamma_3} \end{array}}{\infer{\Gamma}{\case{e}{f}{g}}{C}{\Gamma_2 \sqcup \Gamma_3}}$
\end{center}

\end{frame}

\begin{frame}{Let}

\begin{center}
  $\infrule{\divctx{\Gamma}{r} = (\Gamma_1, \Gamma_2) \quad \infer{\Gamma_1}{e_1}{A}{\Gamma_3} \quad \infer{\extend{\addctx{\Gamma_2}{\scalectx{r}{\Gamma_3}}}[r]{x}{A}}{e_2}{B}{\extend{\Gamma_4}[\Zero]{x}{A}}}{\infer{\Gamma}{\letin[r]{x}{e_1}{e_2}}{B}{\Gamma_4}}$
\end{center}

\end{frame}

\section{Conversion}

\RenewDocumentCommand{\termconv}{m m m m m}{#1 \vdash #2\ \hat{\equiv}\ #3 \mathcolor{blue}{\Leftarrow} #4 \dashv #5}
\NewDocumentCommand{\termconvwhnf}{m m m m m}{#1 \vdash #2\ \equiv #3 \mathcolor{blue}{\Leftarrow} #4 \dashv #5}
\NewDocumentCommand{\termconvne}{m m m m m}{#1 \vdash #2\ \hat{\sim}\ #3 \mathcolor{red}{\Rightarrow} #4 \dashv #5}
\NewDocumentCommand{\termconvnewhnf}{m m m m m}{#1 \vdash #2 \sim #3 \mathcolor{red}{\Rightarrow} #4 \dashv #5}

\RenewDocumentCommand{\typeconv}{m m m m}{#1 \vdash #2\ \hat{\equiv}\ #3 \dashv #4}
\NewDocumentCommand{\typeconvwhnf}{m m m m}{#1 \vdash #2 \equiv #3 \dashv #4}

\RenewDocumentCommand{\propconv}{m m m m}{#1 \vdash #2\ \hat{\equiv}\ #3 \dashv #4}
\NewDocumentCommand{\propconvwhnf}{m m m m}{#1 \vdash #2 \equiv #3 \dashv #4}
\NewDocumentCommand{\propconvnewhnf}{m m m m}{#1 \vdash #2 \sim #3 \dashv #4}

\begin{frame}{Conversion of types}

\begin{center}
  $\infrule{}{\typeconvwhnf{\Gamma}{\Unit}{\Unit}{\Gamma}}$ \quad
  $\infrule{}{\typeconvwhnf{\Gamma}{\Empty}{\Empty}{\Gamma}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \typeconv{\Gamma_1}{B_1}{B_2}{\Gamma_2}}{\typeconvwhnf{\Gamma}{\Prod{A_1}{B_1}}{\Prod{A_2}{B_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \typeconv{\Gamma_1}{B_1}{B_2}{\Gamma_2}}{\typeconvwhnf{\Gamma}{\Sum{A_1}{B_1}}{\Sum{A_2}{B_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \typeconv{\Gamma_1}{B_1}{B_2}{\Gamma_2}}{\typeconvwhnf{\Gamma}{\Fun[r]{A_1}{B_1}}{\Fun[r]{A_2}{B_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma'}}{\typeconvwhnf{\Gamma}{\Box[r]{A_1}}{\Box[r]{A_2}}{\Gamma'}}$
\end{center}

\end{frame}

\begin{frame}{Conversion of propositions}

\begin{center}
  $\infrule{}{\propconvwhnf{\Gamma}{\True}{\True}{\Gamma}}$ \quad
  $\infrule{}{\propconvwhnf{\Gamma}{\False}{\False}{\Gamma}}$

  \vspace{2em}

  $\infrule{\propconv{\Gamma}{P_1}{P_2}{\Gamma_1} \quad \propconv{\Gamma_1}{Q_1}{Q_2}{\Gamma_2}}{\propconvwhnf{\Gamma}{\Impl{P_1}{Q_1}}{\Impl{P_2}{Q_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\propconv{\Gamma}{P_1}{P_2}{\Gamma_1} \quad \propconv{\Gamma_1}{Q_1}{Q_2}{\Gamma_2}}{\propconvwhnf{\Gamma}{\And{P_1}{Q_1}}{\And{P_2}{Q_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\propconv{\Gamma}{P_1}{P_2}{\Gamma_1} \quad \propconv{\Gamma_1}{Q_1}{Q_2}{\Gamma_2}}{\propconvwhnf{\Gamma}{\Or{P_1}{Q_1}}{\Or{P_2}{Q_2}}{\Gamma_2}}$
\end{center}

\end{frame}

\begin{frame}{Conversion of propositions}

\begin{center}
  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \propconv{\extend{\Gamma_1}{x_1}{A_1}}{P_1}{\subst{P_2}{x_2}{x_1}}{\extend{\Gamma_2}{x_1}{A_1}}}{\propconvwhnf{\Gamma}{\All{x_1}[A_1]{P_1}}{\All{x_2}[A_2]{P_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \propconv{\extend{\Gamma_1}{x_1}{A_1}}{P_1}{\subst{P_2}{x_2}{x_1}}{\extend{\Gamma_2}{x_1}{A_1}}}{\propconvwhnf{\Gamma}{\Ex{x_1}[A_1]{P_1}}{\Ex{x_2}[A_2]{P_2}}{\Gamma_2}}$

  \vspace{2em}

  $\infrule{\typeconv{\Gamma}{A_1}{A_2}{\Gamma_1} \quad \termconv{\Gamma_1}{e_1}{e_2}{A_1}{\Gamma_2} \quad \termconv{\Gamma_2}{e_1'}{e_2'}{A_1}{\Gamma_3}}{\propconvwhnf{\Gamma}{\Eq[A_1]{e_1}{e_1'}}{\Eq[A_2]{e_2}{e_2'}}{\Gamma_3}}$
\end{center}

\end{frame}

\begin{frame}{Conversion of propositions}

\begin{center}
  $\infrule{\propconvnewhnf{\Gamma}{N_1}{N_2}{\Gamma'} \quad }{\propconvwhnf{\Gamma}{N_1}{N_2}{\Gamma'}}$
\end{center}

\end{frame}

\begin{frame}{Conversion of terms}

\begin{center}
  $\infrule{\findvar{\Gamma}{x} = A}{\termconvne{\Gamma}{x}{x}{A}{\Gamma}}$

  \vspace{2em}

  $\infrule{\termconv{\extend{\Gamma}{x}{A}}{\app{f}{x}}{\app{g}{x}}{B}{\extend{\Gamma'}{x}{A}}}{\termconvwhnf{\Gamma}{f}{g}{\Fun[r]{A}{B}}{\Gamma'}}$

  \vspace{2em}

  $\infrule{\termconvnewhnf{\Gamma}{n_1}{n_2}{\Fun[r]{A}{B}}{\Gamma_1} \quad \termconv{\Gamma_1}{u_1}{u_2}{A}{\Gamma_2}}{\termconvne{\Gamma}{\app{n_1}{u_1}}{\app{n_2}{u_2}}{B}{\Gamma_2}}$
\end{center}

\end{frame}

\end{document}